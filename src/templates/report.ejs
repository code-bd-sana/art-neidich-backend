<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet" />

    <style>
      @page {
        size: A4;
        margin: 24mm 18mm 30mm 18mm;
      }

      body {
        font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        color: #1f2937;
        margin: 0;
        font-size: 13px;
        line-height: 1.5;
      }

      /* ---------- Header ---------- */
      .header {
        position: relative;
        margin-bottom: 12px;
      }

      .title-block {
        background-color: #1f2937;
        color: white;
        padding: 12px 16px;
        border-radius: 4px;
        margin-bottom: 8px;
      }

      .title-block h1 {
        font-size: 18px;
        margin: 0;
        font-weight: 600;
        letter-spacing: 0.5px;
      }

      .subtitle {
        font-size: 12px;
        color: #d1d5db;
        margin-top: 2px;
      }

      .header-meta {
        display: flex;
        justify-content: space-between;
        font-size: 11px;
        color: #6b7280;
        border-bottom: 1px solid #e5e7eb;
        padding-bottom: 10px;
      }

      /* ---------- Property Info ---------- */
      .property-info {
        background-color: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        padding: 14px 16px;
        margin: 16px 0 20px 0;
      }

      .property-info h2 {
        font-size: 14px;
        font-weight: 600;
        color: #1f2937;
        margin: 0 0 8px 0;
      }

      .property-details {
        display: flex;
        justify-content: space-between;
      }

      .property-address {
        font-weight: 500;
        color: #111827;
      }

      .property-id {
        color: #6b7280;
        font-size: 12px;
      }

      /* ---------- Inspection Details ---------- */
      .inspection-details {
        display: flex;
        justify-content: space-between;
        margin-bottom: 24px;
        padding-bottom: 16px;
        border-bottom: 1px solid #e5e7eb;
        font-size: 12px;
      }

      .detail-column {
        flex: 1;
      }

      .detail-column strong {
        color: #374151;
      }

      /* ---------- Sections ---------- */
      .section {
        margin-top: 32px;
        page-break-inside: avoid;
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 2px solid #0f766e;
        padding-bottom: 6px;
        margin-bottom: 18px;
      }

      .section-header h2 {
        font-size: 16px;
        font-weight: 700;
        color: #0f766e;
        margin: 0;
        text-transform: uppercase;
        letter-spacing: 0.3px;
      }

      .section-subtitle {
        font-size: 11px;
        color: #6b7280;
        font-style: italic;
      }

      /* ---------- Image Grid ---------- */
      .grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      .card {
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        overflow: hidden;
        background: #fff;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        page-break-inside: avoid;
      }

      .card img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        display: block;
        border-bottom: 1px solid #e5e7eb;
      }

      .caption {
        padding: 10px 12px;
        font-size: 11px;
        color: #374151;
        background-color: #f9fafb;
        font-weight: 500;
      }

      /* ---------- Footer ---------- */
      .footer {
        position: fixed;
        bottom: 18mm;
        left: 18mm;
        right: 18mm;
        border-top: 1px solid #e5e7eb;
        padding-top: 12px;
        font-size: 10px;
        color: #6b7280;
      }

      .footer-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .footer-text {
        font-weight: 500;
        color: #4b5563;
      }

      .licenses {
        text-align: right;
        line-height: 1.4;
      }

      /* ---------- Utilities ---------- */
      .utilities-note {
        background-color: #fef3c7;
        border: 1px solid #fde68a;
        border-radius: 4px;
        padding: 8px 12px;
        font-size: 11px;
        color: #92400e;
        margin-top: 24px;
        font-weight: 500;
      }

      /* ---------- Page Break ---------- */
      .page-break {
        page-break-before: always;
        margin-top: 30px;
      }
    </style>
  </head>

  <body>
    <div class="header">
      <div class="title-block">
        <h1>Inspection report</h1>
        <div class="subtitle">Attachment to FHA form # <%= report._id %></div>
      </div>

      <div class="header-meta">
        <div>
          <strong>Type of Inspection:</strong> HUD-FHA 20301 Complexe – FINAL
        </div>
        <div><strong>Date of Inspection:</strong> 09/09/2025</div>
        <div><strong>Class:</strong> # 511-3746727</div>
      </div>
    </div>

    <div class="property-info">
      <h2>Subject Property</h2>
      <div class="property-details">
        <div class="property-address">
          10564 Biskill Drive, Dallas, TX, 75253
        </div>
        <div class="property-id">ID: #<%= report.job?.orderId || "N/A" %></div>
      </div>
    </div>

    <div class="inspection-details">
      <div class="detail-column">
        <strong>Inspection Type:</strong><br />
        HUD-FHA 20301 Complexe – FINAL
      </div>
      <div class="detail-column">
        <strong>Inspector:</strong><br />
        <%= report.inspector?.firstName || "N/A" %> <%=
        report.inspector?.lastName || "" %>
      </div>
      <div class="detail-column">
        <strong>Date:</strong><br />
        <%= new Date(report.createdAt).toLocaleDateString() %>
      </div>
    </div>

    <% if (report.images?.length) { %> <% report.images.forEach(group => { %>
    <div class="section">
      <div class="section-header">
        <h2><%= group.imageLabel %></h2>
        <div class="section-subtitle">
          <%= group.images?.length || 0 %> photos
        </div>
      </div>
      <div class="grid">
        <% group.images.forEach(img => { %>
        <div class="card">
          <img src="<%= img.url %>" alt="<%= img.fileName %>" />
          <div class="caption"><%= img.fileName %></div>
        </div>
        <% }) %>
      </div>
    </div>
    <% }) %> <% } else { %>
    <!-- Static content for demo purposes -->
    <div class="section">
      <div class="section-header">
        <h2>Exterior Front Elevation</h2>
        <div class="section-subtitle">2 photos</div>
      </div>
      <div class="grid">
        <div class="card">
          <img
            src="https://via.placeholder.com/400x300/0f766e/ffffff?text=Front+View+1"
            alt="front_elevation_1.jpg" />
          <div class="caption">front_elevation_1.jpg</div>
        </div>
        <div class="card">
          <img
            src="https://via.placeholder.com/400x300/0f766e/ffffff?text=Front+View+2"
            alt="front_elevation_2.jpg" />
          <div class="caption">front_elevation_2.jpg</div>
        </div>
      </div>
    </div>

    <div class="section">
      <div class="section-header">
        <h2>Exterior Left Elevation</h2>
        <div class="section-subtitle">2 photos</div>
      </div>
      <div class="grid">
        <div class="card">
          <img
            src="https://via.placeholder.com/400x300/0f766e/ffffff?text=Left+Side+1"
            alt="left_elevation_1.jpg" />
          <div class="caption">left_elevation_1.jpg</div>
        </div>
        <div class="card">
          <img
            src="https://via.placeholder.com/400x300/0f766e/ffffff?text=Left+Side+2"
            alt="left_elevation_2.jpg" />
          <div class="caption">left_elevation_2.jpg</div>
        </div>
      </div>
    </div>
    <% } %>

    <div class="footer">
      <div class="footer-content">
        <div class="footer-text">
          TREC Lic. # 18546 | TSBPE Lic. # 19384 | Code Enforcement Lic. # 7055
        </div>
        <div class="licenses">
          HUD-FHA Fee Reg.#<br />
          DE63 & 203K - D0931
        </div>
      </div>
    </div>
  </body>
</html>
